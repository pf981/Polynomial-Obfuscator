####################################################################################################
#
# TITLE:       Polynomials
#
# DESCRIPTION:
#
# AUTHOR:      Paul Foster
#
####################################################################################################

if (!require('pacman'))
    install.packages('pacman')

pacman::p_load('magrittr',
               'polynom')





poly.calc(x=c(1, 2, 3))
poly.calc(x=c('hello'))




strToAscii <- function(x) {
    strtoi(charToRaw(x), 16L)
}
asciiToStr <- function(n) {
    rawToChar(as.raw(n))
}
raw_str <- 'Hello World!'
str_ascii <- toAscii(raw_str)
asciiToStr(str_ascii)


result <- poly.calc(x=seq_len(nchar(raw_str)), y=str_ascii)




solve(result, c(1,2,3))


as.function(result)(seq_len(nchar(raw_str)))



as.function(result)(seq_len(12))

result %>%
    as.function %>%
    seq_len(12)


poly_func <- polynomial(coef=c(55920, -163635.6, 196773.7, -130574, 53823.09 -14611.77, 2686.312, -336.5522, 28.30695, -1.52901, 0.04791556, -0.0006620771))

as.function(poly_func)(seq_len(12))
as.function(poly_func)(seq_len(12)) %>%
    as.integer


55920, -163635.6, 196773.7, -130574, 53823.09 -14611.77, 2686.312, -336.5522, 28.30695, -1.52901, 0.04791556, -0.0006620771


polyFunc <- function(x) {
    55920 - 163635.629978355*x + 196773.744702381*x^2 - 130574.01542328*x^3 + 53823.0885774912*x^4 - 14611.7727375441*x^5 + 2686.31185185185*x^6 - 336.552189153439*x^7 + 28.3069527116402*x^8 - 1.52900958994709*x^9 + 0.0479155643738977*x^10 - 0.000662077120410454*x^1
}

polyFunc((seq_len(12)))


 result %>% as.character



poly_func <- polynomial(coef=c(55920, -163635.629978355, 196773.744702381, -130574.01542328, 53823.0885774912 -14611.7727375441, 2686.31185185185, -336.552189153439, 28.3069527116402, -1.52900958994709, 0.0479155643738977, -0.000662077120410454) %>% rev)

as.function(poly_func)(seq_len(12))



print(result, digits=100)

55920 - 163635.629978355*x + 196773.744702381*x^2 - 130574.01542328*x^3 +
53823.0885774912*x^4 - 14611.7727375441*x^5 + 2686.31185185185*x^6 -
336.552189153439*x^7 + 28.3069527116402*x^8 - 1.52900958994709*x^9 +
0.0479155643738977*x^10 - 0.000662077120410454*x^11


poly_func <- polynomial(coef=c(55920, -163635.629978355, 196773.744702381, -130574.01542328, 53823.0885774912 -14611.7727375441, 2686.31185185185, -336.552189153439, 28.3069527116402, -1.52900958994709, 0.0479155643738977, -0.000662077120410454) %>% rev)

poly_func <- polynomial(coef=coef(result))

paste0(coef(result), collapse=', ')

poly_func <- polynomial(coef=c(55920, -163635.629978355, 196773.744702381, -130574.01542328, 53823.0885774912, -14611.7727375441, 2686.31185185185, -336.552189153439, 28.3069527116402, -1.52900958994709, 0.0479155643738977, -0.000662077120410454))

as.function(poly_func)(seq_len(12)) %>%
    round %>%
    asciiToStr







