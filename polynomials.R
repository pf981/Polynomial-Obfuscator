####################################################################################################
#
# TITLE:       Polynomials
#
# DESCRIPTION:
#
# AUTHOR:      Paul Foster
#
####################################################################################################

if (!require('pacman'))
    install.packages('pacman')

pacman::p_load('magrittr',
               'polynom')


## Generate the Polynomial


strToAscii <- function(x) {
    strtoi(charToRaw(x), 16L)
}

asciiToStr <- function(n) {
    rawToChar(as.raw(n))
}

raw_str <- 'Hello World!'
str_ascii <- toAscii(raw_str)
asciiToStr(str_ascii)

result <- poly.calc(x=seq_len(nchar(raw_str)), y=str_ascii)

paste0(coef(result), collapse=', ')

poly_func <- polynomial(coef=c(55920, -163635.629978355, 196773.744702381, -130574.01542328, 53823.0885774912, -14611.7727375441, 2686.31185185185, -336.552189153439, 28.3069527116402, -1.52900958994709, 0.0479155643738977, -0.000662077120410454))

as.function(poly_func)(seq_len(12)) %>%
    round %>%
    asciiToStr




## Final Obfuscated Code ####


as.function(polynomial(coef=c(55920, -163635.629978355, 196773.744702381, -130574.01542328, 53823.0885774912, -14611.7727375441, 2686.31185185185, -336.552189153439, 28.3069527116402, -1.52900958994709, 0.0479155643738977, -0.000662077120410454)))(seq_len(12)) %>%
    round %>%
    as.raw %>%
    rawToChar



## More Obfuscated ####


if (!require('pacman'))
    install.packages('pacman')

pacman::p_load('magrittr',
               'polynom')

polynomial(coef=c(55920,
                  -163635.629978355,
                  196773.744702381,
                  -130574.01542328,
                  53823.0885774912,
                  -14611.7727375441,
                  2686.31185185185,
                  -336.552189153439,
                  28.3069527116402,
                  -1.52900958994709,
                  0.0479155643738977,
                  -0.000662077120410454)) %>%
predict(seq_len(12)) %>%
            round %>%
            as.raw %>%
            rawToChar


seq_len(12) %>%
    predict(object=polynomial(coef=c(55920,
                                     -163635.629978355,
                                     196773.744702381,
                                     -130574.01542328,
                                     53823.0885774912,
                                     -14611.7727375441,
                                     2686.31185185185,
                                     -336.552189153439,
                                     28.3069527116402,
                                     -1.52900958994709,
                                     0.0479155643738977,
                                     -0.000662077120410454))) %>%
    round %>%
    as.raw %>%
    rawToChar

seq_len(12) %>%
    (polynomial(coef=c(55920,
                       -163635.629978355,
                       196773.744702381,
                       -130574.01542328,
                       53823.0885774912,
                       -14611.7727375441,
                       2686.31185185185,
                       -336.552189153439,
                       28.3069527116402,
                       -1.52900958994709,
                       0.0479155643738977,
                       -0.000662077120410454)) %>%
         as.function) %>%
    round %>%
    as.raw %>%
    rawToChar


predict(polynomial(coef=c(55920,
                       -163635.629978355,
                       196773.744702381,
                       -130574.01542328,
                       53823.0885774912,
                       -14611.7727375441,
                       2686.31185185185,
                       -336.552189153439,
                       28.3069527116402,
                       -1.52900958994709,
                       0.0479155643738977,
                       -0.000662077120410454)), seq_len(12))















seq_len(12) %>%
    (polynomial(coef=c(55920,
                                     -163635.629978355,
                                     196773.744702381,
                                     -130574.01542328,
                                     53823.0885774912,
                                     -14611.7727375441,
                                     2686.31185185185,
                                     -336.552189153439,
                                     28.3069527116402,
                                     -1.52900958994709,
                                     0.0479155643738977,
                                     -0.000662077120410454)) %>%
    predict(object=.)) %>%
    round %>%
    as.raw %>%
    rawToChar














































